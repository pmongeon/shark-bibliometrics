---
title: "Mapping the Shark research"
author: "Rémi Toupin and Philippe Mongeon"
date: "2020-12-07"
abstract: ""
output: 
  html_document:
    toc: true # adds table on content
    toc_float: true # makes table of content float on the left of the page rather than being at the top of the page
    toc_depth: 3  # up to N depths of headings in the TOC (specified by #, ## and ###)
    number_sections: true # will automatically number your headings
    theme: cosmo  # many options for theme, this one is my favorite.
    highlight: tango  # specifies the syntax highlighting style
#    css: my.css   # you can add your custom css, should be in same folder
---

# Data collection

```{css, echo=FALSE}

# Just to format the page... code won't be displayed because of echo = FALSE

h1 {
  padding-top: 30px;
}
h2 {
  padding-top: 20px;
}
h3{
  padding-top:10px;
}
```

# Summary

# Publications data

We collect all publications containing the term “shark” and published between 1980 and 2020 from the Web of 
Science (WoS) database hosted by the Centre for Science and Technology Studies (CWTS) using the following SQL code:

```{sql eval=FALSE}
SELECT DISTINCT ut INTO #data from wos_2013_text..text_data where CONTAINS(title, 'shark')
union select ut from wos_2013_text..text_data where CONTAINS(title, 'sharks') 
union select ut from wos_2013_text..text_data where CONTAINS(keyword, 'shark')
union select ut from wos_2013_text..text_data where CONTAINS(keyword, 'sharks')
union select ut from wos_2013_text..text_data where CONTAINS(keyword_plus, 'shark')
UNION select ut from wos_2013_text..text_data where CONTAINS(keyword_plus, 'sharks')
UNION select ut from wos_2013_text..text_data where CONTAINS(abstract, 'shark')
UNION SELECT ut from wos_2013_text..text_data WHERE CONTAINS(abstract, 'sharks')
```
```{r}
# Load needed packages ----
library(sqldf)
library(tidyverse)
library(readxl)

# Load data ----
Articles <- read_excel("data/shark_data.xlsx", sheet ="papers")
Citations <- read_excel("data/shark_data.xlsx", sheet ="citations")

# bibliographic coupling network
BCNetwork <- sqldf("
      SELECT DISTINCT
        a.ut as Source,
        d.ut as Target,
        count(distinct b.cited_ut) as Weight,
        'undirected' as Type
      FROM Articles a
      JOIN Citations b on b.citing_ut = a.ut
      JOIN Citations c on c.cited_ut = b.cited_ut
      JOIN Articles d on d.ut = c.citing_ut
      WHERE d.ut > a.ut
      GROUP BY a.ut, d.ut
      ORDER BY count(distinct b.cited_ut) desc
      ")

# co-citation network
CCNetwork <- sqldf("
      SELECT DISTINCT
        a.ut as Source,
        d.ut as Target,
        count(distinct b.citing_ut) as Weight,
        'undirected' as Type
      FROM Articles a
      JOIN Citations b on b.cited_ut = a.ut
      JOIN Citations c on c.citing_ut = b.citing_ut
      JOIN Articles d on d.ut = c.cited_ut
      WHERE d.ut > a.ut
      GROUP BY a.ut, d.ut
      ORDER BY count(distinct b.cited_ut) desc
      ")

# Combined BC+CC network
CCBCNetwork <- rbind(CCNetwork,BCNetwork) %>%
  group_by(Source, Target, Type) %>% 
  summarize(Weight = sum(Weight))
```

## Community detection

### macro-clusters

### meso-clusters

### micro-clusters

# Describing the research areas

# Mapping the research areas





